{% extends "base.html" %}

{% block title %}{{ media.title }}{% endblock %}

{% block content %}
    <div class="banner" style="background-image: url('{{ url_for('static', filename='uploads/' + media.banner_img) if media.banner_img else '' }}');"></div>
    
    <div class="header-section">
        <div class="poster {% if media.media_type in ['album', 'single'] %}poster-square{% endif %}">
            {% if media.poster_img %}
                <img src="{{ url_for('static', filename='uploads/' + media.poster_img) }}" alt="{{ media.title }} Poster">
            {% else %}
                <div class="placeholder">?</div>
            {% endif %}
        </div>
        <div class="title-info">
            <h1>{{ media.title }}</h1>
            {% if media.creator %}
                <p class="creator">{{ media.creator }}</p>
            {% endif %}
            <p class="years">{{ media.years }}</p>
            <div class="overall-score">
                ‚≠ê {{ media.overall_score }}
            </div>
            {% if current_user.is_authenticated %}
                <div style="margin-top: 20px;">
                    <a href="{{ url_for('main.edit_media', media_id=media.id) }}" class="btn btn-primary">Edit</a>
                    <form action="{{ url_for('main.delete_media', media_id=media.id) }}" method="POST" style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this?');">
                        <button type="submit" class="btn btn-danger">Delete</button>
                    </form>
                </div>
            {% endif %}
        </div>
    </div>
    <hr>
    
    {% if media.media_type == 'tv_show' %}
        {% for season in media.seasons | sort(attribute='season_number') %}
            <h2 class="season-header">Season {{ season.season_number }}</h2>
            <div class="ratings-grid">
                {% for episode in season.episodes %}
                    <div class="rating-item {{ get_rating_class(episode.rating) }}" data-title="E{{ episode.episode_number }}: {{ episode.title }}">
                        {{ episode.rating }}
                    </div>
                {% endfor %}
            </div>
        {% endfor %}
    {% elif media.media_type == 'album' %}
        <h2 class="album-header">Tracks</h2>
        <div class="ratings-grid">
            {% for track in media.tracks | sort(attribute='track_number') %}
                <div class="rating-item {{ get_rating_class(track.rating) }}" data-title="T{{ track.track_number }}: {{ track.title }}">
                    {{ track.rating }}
                </div>
            {% endfor %}
        </div>
    {% elif media.media_type in ['movie', 'single'] %}
        <div class="single-rating-display">
            <div class="label">Overall Score</div>
            <div class="score-box {{ get_rating_class(media.overall_score) }}">
                {{ media.overall_score }}
            </div>
        </div>
    {% endif %}

{% endblock %}
